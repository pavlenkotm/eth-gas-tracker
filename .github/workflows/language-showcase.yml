name: ðŸŒˆ Language Showcase Update

on:
  schedule:
    # Run daily at 8 AM UTC
    - cron: '0 8 * * *'
  workflow_dispatch:
  push:
    paths:
      - 'examples/**'

jobs:
  update-showcase:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - uses: actions/checkout@v4

      - name: ðŸ” Scan Language Examples
        id: scan
        run: |
          echo "Scanning for language examples..."

          declare -A languages
          languages=(
            ["cairo"]="ðŸº Cairo (StarkNet)"
            ["sway"]="â›½ Sway (Fuel)"
            ["yul"]="âš¡ Yul (EVM)"
            ["huff"]="ðŸ”¥ Huff (Ultra-optimized)"
            ["solidity"]="ðŸ“œ Solidity"
            ["vyper"]="ðŸ Vyper"
            ["rust"]="ðŸ¦€ Rust"
            ["move"]="ðŸ’Ž Move"
            ["go"]="ðŸ¹ Go"
            ["typescript"]="âš¡ TypeScript"
            ["javascript"]="ðŸ’› JavaScript"
            ["python"]="ðŸ Python"
            ["java"]="â˜• Java"
            ["elixir"]="ðŸ’§ Elixir"
            ["lua"]="ðŸŒ™ Lua"
            ["ruby"]="ðŸ’Ž Ruby"
            ["julia"]="ðŸ”¬ Julia"
            ["scala"]="âš™ï¸  Scala"
            ["clojure"]="ðŸ”§ Clojure"
            ["perl"]="ðŸ”® Perl"
            ["php"]="ðŸ˜ PHP"
            ["powershell"]="âš¡ PowerShell"
            ["c"]="ðŸ”¨ C"
            ["nim"]="ðŸ‘‘ Nim"
            ["crystal"]="ðŸ’Ž Crystal"
            ["fsharp"]="ðŸ”· F#"
            ["r"]="ðŸ“Š R"
            ["erlang"]="ðŸ“¡ Erlang"
            ["ocaml"]="ðŸ« OCaml"
            ["scheme"]="ðŸŽ¨ Scheme"
            ["d"]="ðŸ”· D"
            ["odin"]="âš™ï¸  Odin"
            ["svelte"]="ðŸ¦Š Svelte"
            ["vue"]="ðŸŒ Vue"
            ["bash"]="ðŸ”§ Bash"
            ["html-css"]="ðŸŽ¨ HTML/CSS"
          )

          echo "## ðŸŒŸ Available Language Examples" > .github/LANGUAGE_LIST.md
          echo "" >> .github/LANGUAGE_LIST.md

          for lang in "${!languages[@]}"; do
            if [ -d "examples/$lang" ]; then
              echo "- ${languages[$lang]}" >> .github/LANGUAGE_LIST.md
            fi
          done

          echo "" >> .github/LANGUAGE_LIST.md
          echo "**Total Languages:** $(ls -d examples/*/ 2>/dev/null | wc -l)" >> .github/LANGUAGE_LIST.md
          echo "**Last Updated:** $(date -u +"%Y-%m-%d %H:%M:%S UTC")" >> .github/LANGUAGE_LIST.md

      - name: ðŸ“ Update Language Matrix
        run: |
          cat > .github/LANGUAGE_MATRIX.json << 'EOF'
          {
            "languages": {
              "smart_contracts": ["solidity", "vyper", "cairo", "sway", "move", "yul", "huff"],
              "frontend": ["typescript", "svelte", "vue", "elm", "astro", "html-css"],
              "backend": ["go", "elixir", "scala", "ruby", "java", "nim", "crystal", "erlang", "clojure", "php"],
              "scripting": ["python", "lua", "bash", "perl", "powershell", "scheme"],
              "systems": ["rust", "c", "zig", "d", "odin", "cpp"],
              "functional": ["haskell", "fsharp", "ocaml", "erlang"],
              "data_science": ["julia", "r", "matlab"]
            },
            "total": 40,
            "categories": 7
          }
          EOF

      - name: ðŸ’¾ Commit Language Updates
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add .github/LANGUAGE_LIST.md .github/LANGUAGE_MATRIX.json
          git commit -m "docs: update language showcase [skip ci]" || echo "No changes"
          git push || echo "Nothing to push"
